# Selenium Test Suite for EMS Client

This directory contains Selenium WebDriver tests for the EMS Client application, written in TypeScript.

## Prerequisites

1. **Node.js** (v14 or higher)
2. **ChromeDriver** or **GeckoDriver** (for Firefox) installed and in PATH
   - ChromeDriver: https://chromedriver.chromium.org/
   - GeckoDriver: https://github.com/mozilla/geckodriver/releases
   - Or use a driver manager like `webdriver-manager`

## Installation

```bash
cd selenium-tests
npm install
```

## Configuration

Edit `src/config/test.config.ts` to configure:
- Base URL (default: `http://localhost`)
- Browser (chrome, firefox, edge)
- Headless mode
- Test credentials
- Timeouts

Or set environment variables:
- `TEST_BASE_URL`: Base URL for the application
- `TEST_BROWSER`: Browser to use (chrome, firefox, edge)
- `HEADLESS`: Set to `true` to run in headless mode
- `TEST_USER_EMAIL`: Valid test user email
- `TEST_USER_PASSWORD`: Valid test user password
- `TAKE_SCREENSHOTS`: Set to `true` to enable screenshots

## Running Tests

### Run all tests:
```bash
npm test
```

### Run only login tests:
```bash
npm run test:login
```

### Run in watch mode:
```bash
npm run test:watch
```

### Run with coverage:
```bash
npm run test:coverage
```

### Run with custom base URL:
```bash
TEST_BASE_URL=http://localhost:3000 npm test
```

### Run in headless mode:
```bash
HEADLESS=true npm test
```

## Building TypeScript

To compile TypeScript to JavaScript:
```bash
npm run build
```

Compiled files will be in the `dist/` directory.

## Test Structure

- `src/config/`: Test configuration files (TypeScript)
- `src/utils/`: Utility functions for driver setup and helpers (TypeScript)
- `src/tests/`: Test files (TypeScript)
  - `login.test.ts`: Login functionality tests
- `dist/`: Compiled JavaScript files (generated)
- `screenshots/`: Screenshot directory (created automatically if enabled)
- `reports/`: Test reports (HTML reports generated by jest-html-reporter)

## Test IDs

The following test IDs are used in the application:

### Landing Page:
- `landing-sign-in-button`: Sign In button in navigation
- `landing-sign-in-cta-button`: Sign In to Account button in hero section

### Login Page:
- `login-email-input`: Email input field
- `login-password-input`: Password input field
- `login-submit-button`: Sign In submit button
- `login-error-message`: Error message container

## Writing New Tests

1. Create a new test file in `src/tests/` directory with `.test.ts` extension
2. Follow the structure of `login.test.ts`
3. Use helper functions from `src/utils/helpers.ts`
4. Use test IDs for element selection (preferred) or CSS selectors
5. Import types from `selenium-webdriver` for type safety

Example:
```typescript
import { WebDriver } from 'selenium-webdriver';
import { createDriver, quitDriver } from '../utils/driver.setup';
import { navigateTo, clickByTestId } from '../utils/helpers';

describe('My Feature', () => {
  let driver: WebDriver | null = null;

  beforeAll(async () => {
    driver = await createDriver();
  });

  afterAll(async () => {
    await quitDriver(driver);
  });

  it('should test something', async () => {
    if (!driver) throw new Error('Driver not initialized');
    await navigateTo(driver, '/my-page');
    await clickByTestId(driver, 'my-button');
    // ... assertions
  });
});
```

## TypeScript Configuration

The project uses TypeScript with strict type checking. Configuration is in `tsconfig.json`:
- Source files in `src/`
- Compiled output in `dist/`
- Target: ES2020
- Module: CommonJS
- Strict mode enabled

## Notes

- Tests are configured with a 30-second timeout by default
- Screenshots are disabled by default (set `TAKE_SCREENSHOTS=true` to enable)
- The test suite assumes the application is running and accessible at the configured base URL
- Make sure Docker containers are running before executing tests
- Test reports are generated in HTML format in the `reports/` directory
- TypeScript compilation is optional - Jest runs tests directly from TypeScript using ts-jest

